<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Map Data</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <!-- <script src="main.js"></script> -->
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
</head>
<body>
    <h1>St. Himark Map</h1>
    <h4>YINT Activity</h4>
        <div id ="map" style="width:900px; height:350px"></div>
        <div></div>
        <script>
            geojsonData = {"type": "FeatureCollection","name": "StHimark","crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },"features": [{ "type": "Feature", "properties": { "Name": "Palace Hills", "description": null, "altitudeMode": "absolute", "Nbrhood": "Palace Hills", "Id": "1", "FID": "0", "Field_1": "Palace Hills" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.938508168686596, 0.156228563443555 ], [ -119.938487374849203, 0.199694575550337 ], [ -119.941842802707995, 0.199296782818922 ], [ -119.950160337508194, 0.200071703715306 ], [ -119.956101433794004, 0.198625184679451 ], [ -119.963778578686401, 0.194259796110899 ], [ -119.970370827735394, 0.19130002757751 ], [ -119.977366683869107, 0.185111419003877 ], [ -119.980191933461498, 0.177577457832323 ], [ -119.976559469699794, 0.161836850628635 ], [ -119.973868755802201, 0.156051838011083 ], [ -119.982882647359105, 0.155379162020967 ], [ -119.982882647359105, 0.150939499953287 ], [ -119.970236292040596, 0.149863218102386 ], [ -119.964720328550499, 0.139638537935302 ], [ -119.967168189374604, 0.126872835574757 ], [ -119.973841159840504, 0.125150782845089 ], [ -119.975347959623093, 0.115679490853369 ], [ -119.964154589809297, 0.114603207467659 ], [ -119.954683276889995, 0.138066175453788 ], [ -119.945373406804407, 0.141402650763727 ], [ -119.945857735306006, 0.156309155406508 ], [ -119.938508168686596, 0.156228563443555 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Northwest", "description": null, "altitudeMode": "absolute", "Nbrhood": "Northwest", "Id": "2", "FID": "1", "Field_1": "Northwest" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.938508168686596, 0.156228563443555 ], [ -119.938431364948798, 0.155179059744644 ], [ -119.928368094971802, 0.154579929639117 ], [ -119.925780704488005, 0.154554098879624 ], [ -119.922551847810894, 0.156555982641459 ], [ -119.9212818308512, 0.158643968726901 ], [ -119.919322991133797, 0.161610917664127 ], [ -119.918838662632197, 0.165754600156426 ], [ -119.915771248789, 0.17027498006765 ], [ -119.908237249875896, 0.170382608147893 ], [ -119.9008367674478, 0.168566605040117 ], [ -119.897930796438402, 0.16781320839491 ], [ -119.891204011694498, 0.168781861219176 ], [ -119.890199191496706, 0.168621710622167 ], [ -119.890522211700301, 0.197830448710626 ], [ -119.891858958364693, 0.200684740752351 ], [ -119.892846988507898, 0.202600517183344 ], [ -119.899175547595306, 0.200964573278845 ], [ -119.904427821123605, 0.200073414293451 ], [ -119.907940817188404, 0.203276420274656 ], [ -119.916981615884595, 0.201519933201614 ], [ -119.921303978689807, 0.200400603105281 ], [ -119.923887064031604, 0.197731431029023 ], [ -119.930861394454496, 0.196353793660177 ], [ -119.930775291609706, 0.201347728576514 ], [ -119.935683153759101, 0.202036547066382 ], [ -119.938487374849203, 0.199694575550337 ], [ -119.938508168686596, 0.156228563443555 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Old Town", "description": null, "altitudeMode": "absolute", "Nbrhood": "Old Town", "Id": "3", "FID": "2", "Field_1": "Old Town" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.892846988507898, 0.202600517183344 ], [ -119.890522211700301, 0.197830448710626 ], [ -119.890199191496706, 0.168621710622193 ], [ -119.8832806117681, 0.166918362598911 ], [ -119.877081206947807, 0.167744946383168 ], [ -119.870106876525, 0.165213533434341 ], [ -119.861863155971093, 0.165297369703459 ], [ -119.856567831020499, 0.163553794277497 ], [ -119.853791014278002, 0.163682948017941 ], [ -119.846687529588095, 0.166072292065914 ], [ -119.832286828807597, 0.166072292065914 ], [ -119.827443543791702, 0.17472558968421 ], [ -119.8220340673424, 0.18234852452284 ], [ -119.820742524671502, 0.190097739611404 ], [ -119.814290816772896, 0.211452984862386 ], [ -119.815096739399493, 0.213256999274417 ], [ -119.818540853188594, 0.217217702184021 ], [ -119.818885264567498, 0.224105878673875 ], [ -119.833694953860501, 0.223072652404469 ], [ -119.832833925413198, 0.217045497731179 ], [ -119.834900393686596, 0.212051567750885 ], [ -119.831284074208099, 0.207746454404619 ], [ -119.830423045760796, 0.201030475251446 ], [ -119.835589216444404, 0.200341656718971 ], [ -119.840755387127999, 0.20946849988523 ], [ -119.845749352122098, 0.216356679899991 ], [ -119.854015225215804, 0.213084794776806 ], [ -119.857631544694399, 0.214979044144043 ], [ -119.858320367452194, 0.227549965710356 ], [ -119.871752411229494, 0.222211630457845 ], [ -119.8800505728899, 0.216604223811708 ], [ -119.887369314691696, 0.216496596024547 ], [ -119.892804556765, 0.212245297823536 ], [ -119.892846988507898, 0.202600517183344 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Safe Town", "description": null, "altitudeMode": "absolute", "Nbrhood": "Safe Town", "Id": "4", "FID": "3", "Field_1": "Safe Town" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.815096739399493, 0.213256999274417 ], [ -119.814290816772896, 0.211452984862386 ], [ -119.820742524671502, 0.190097739611404 ], [ -119.8220340673424, 0.18234852452284 ], [ -119.827443543791702, 0.17472558968421 ], [ -119.832286828807597, 0.166072292065914 ], [ -119.838139162565099, 0.15630684707498 ], [ -119.845328750099796, 0.148772874867194 ], [ -119.845430682091703, 0.135351852209671 ], [ -119.773532568071303, 0.134693442804837 ], [ -119.765370018391195, 0.137018213077056 ], [ -119.765364278201602, 0.139311412173961 ], [ -119.759982850406203, 0.143616541287128 ], [ -119.768808391990603, 0.145984361955343 ], [ -119.771176220220596, 0.151581027990836 ], [ -119.774405076897906, 0.156962436277068 ], [ -119.773601450347002, 0.160234331841238 ], [ -119.773773656036497, 0.169877810424186 ], [ -119.780317472235694, 0.179176874503204 ], [ -119.776098432844094, 0.181932151853491 ], [ -119.781522912061902, 0.187442705285508 ], [ -119.774806890173195, 0.196913964917158 ], [ -119.777045564136003, 0.199410932479813 ], [ -119.7874384601554, 0.189432409504501 ], [ -119.795241530458796, 0.188087059856633 ], [ -119.797125030187104, 0.190508689147588 ], [ -119.793627102120098, 0.19266124823176 ], [ -119.809233242726705, 0.210688919593073 ], [ -119.810678444865999, 0.217427242325179 ], [ -119.812970933106797, 0.218040720664058 ], [ -119.815096739399493, 0.213256999274417 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Southwest", "description": null, "altitudeMode": "absolute", "Nbrhood": "Southwest", "Id": "5", "FID": "4", "Field_1": "Southwest" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.945373406804407, 0.141402650763765 ], [ -119.942560481959603, 0.141307620308917 ], [ -119.9454018758356, 0.126132035300012 ], [ -119.941075207888105, 0.114895638936958 ], [ -119.919323476739194, 0.098896681997821 ], [ -119.9097445352634, 0.097066999222901 ], [ -119.8920934520945, 0.087057556457251 ], [ -119.875018970975802, 0.0842330992965 ], [ -119.870469296660403, 0.084334126525017 ], [ -119.871330325107706, 0.087519928196863 ], [ -119.877701935617395, 0.095183071631745 ], [ -119.883470826214094, 0.104223856630255 ], [ -119.895266915941704, 0.117655875197667 ], [ -119.900949703693598, 0.123769163602705 ], [ -119.901035806538403, 0.12531901114621 ], [ -119.925020830222493, 0.125175865508885 ], [ -119.925182273056393, 0.135938693142033 ], [ -119.928518758289599, 0.135992507268494 ], [ -119.928368094971802, 0.154579929639117 ], [ -119.938431364948698, 0.155179059744682 ], [ -119.938508168686596, 0.156228563443594 ], [ -119.945857735306006, 0.156309155406534 ], [ -119.945373406804407, 0.141402650763765 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Downtown", "description": null, "altitudeMode": "absolute", "Nbrhood": "Downtown", "Id": "6", "FID": "5", "Field_1": "Downtown" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.901035806538403, 0.12531901114621 ], [ -119.9008367674478, 0.168566605040117 ], [ -119.908237249875896, 0.170382608147931 ], [ -119.915771248789, 0.170274980067688 ], [ -119.918838662632297, 0.165754600156426 ], [ -119.919322991133797, 0.161610917664127 ], [ -119.922551847810894, 0.156555982641459 ], [ -119.925780704488005, 0.154554098879624 ], [ -119.928368094971802, 0.154579929639117 ], [ -119.928518758289599, 0.135992507268494 ], [ -119.925182273056393, 0.135938693142033 ], [ -119.925020830222493, 0.125175865508885 ], [ -119.901035806538403, 0.12531901114621 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Wilson Forest", "description": null, "altitudeMode": "absolute", "Nbrhood": "Wilson Forest", "Id": "7", "FID": "6", "Field_1": "Wilson Forest" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.712027355344404, 0.054377010619721 ], [ -119.712040584687699, 0.143930104254254 ], [ -119.716948446837193, 0.147029796672104 ], [ -119.730046169412802, 0.138590847205891 ], [ -119.729651531374401, 0.054377010619721 ], [ -119.712027355344404, 0.054377010619721 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Scenic Vista", "description": null, "altitudeMode": "absolute", "Nbrhood": "Scenic Vista", "Id": "8", "FID": "7", "Field_1": "Scenic Vista" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.712027355344404, 0.054377010619721 ], [ -119.729651531374401, 0.054377010619721 ], [ -119.729669453693504, 0.058201550205917 ], [ -119.739530290402698, 0.057986737472272 ], [ -119.741736675798805, 0.05416592556817 ], [ -119.741629047242895, 0.051259955788781 ], [ -119.745034363111799, 0.051564155820906 ], [ -119.779088038201294, 0.032449329517436 ], [ -119.783554623271499, 0.032449329517436 ], [ -119.787967394063699, 0.030189130181205 ], [ -119.796254792868694, 0.023462346178058 ], [ -119.806102805734298, 0.023516160451511 ], [ -119.806264248568098, 0.015659276335442 ], [ -119.803412091836506, 0.012753305415608 ], [ -119.745117775242704, 0.038472042968873 ], [ -119.712054282867598, 0.048416918663456 ], [ -119.712027355344404, 0.054377010619721 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Broadview", "description": null, "altitudeMode": "absolute", "Nbrhood": "Broadview", "Id": "9", "FID": "8", "Field_1": "Broadview" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.803412091836506, 0.012753305415608 ], [ -119.806264248568098, 0.015659276335442 ], [ -119.806102805734298, 0.023516160451511 ], [ -119.805655217707795, 0.037952143345186 ], [ -119.803588749434397, 0.040147765375631 ], [ -119.799972429955801, 0.041353204896922 ], [ -119.794634053582797, 0.043118312734119 ], [ -119.792739790998795, 0.045313934620777 ], [ -119.792170705009397, 0.069316211534405 ], [ -119.844843851199599, 0.0693871117937 ], [ -119.844947174613196, 0.078996181198001 ], [ -119.871081540559004, 0.079526574213962 ], [ -119.874629695285506, 0.078071796275809 ], [ -119.873338152614593, 0.073013258546541 ], [ -119.873876295394098, 0.064080094808172 ], [ -119.876459380735895, 0.057622385099126 ], [ -119.866449925036505, 0.051918074244577 ], [ -119.852242955656607, 0.03814162337611 ], [ -119.847830184864307, 0.023934656117205 ], [ -119.843955556851597, 0.019091371444149 ], [ -119.831652267554304, 0.016108715229604 ], [ -119.816670372571906, 0.008531665074332 ], [ -119.805477002757399, 0.009134384980265 ], [ -119.803412091836506, 0.012753305415608 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Chapparal", "description": null, "altitudeMode": "absolute", "Nbrhood": "Chapparal", "Id": "10", "FID": "9", "Field_1": "Chapparal" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.792170705009397, 0.069316211534405 ], [ -119.792739790998795, 0.045313934620815 ], [ -119.794634053582797, 0.043118312734119 ], [ -119.803588749434397, 0.040147765375631 ], [ -119.805655217707795, 0.037952143345186 ], [ -119.806102805734298, 0.023516160451511 ], [ -119.796254792868694, 0.023462346178058 ], [ -119.787967394063699, 0.030189130181205 ], [ -119.783554623271499, 0.032449329517436 ], [ -119.779088038201294, 0.032449329517436 ], [ -119.771132758817998, 0.036914744685846 ], [ -119.771678958331904, 0.082737352532163 ], [ -119.792847073636594, 0.082973327894255 ], [ -119.792170705009397, 0.069316211534405 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Terrapin Springs", "description": null, "altitudeMode": "absolute", "Nbrhood": "Terrapin Springs", "Id": "11", "FID": "10", "Field_1": "Terrapin Springs" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.771132758817998, 0.036914744685846 ], [ -119.745034363111799, 0.051564155820944 ], [ -119.741629047242895, 0.051259955788781 ], [ -119.741736675798805, 0.05416592556817 ], [ -119.739530290402698, 0.057986737472272 ], [ -119.729669453693504, 0.058201550205917 ], [ -119.729785158157895, 0.082892338070755 ], [ -119.771678958331904, 0.082737352532163 ], [ -119.771132758817998, 0.036914744685846 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Pepper Mill", "description": null, "altitudeMode": "absolute", "Nbrhood": "Pepper Mill", "Id": "12", "FID": "11", "Field_1": "Pepper Mill" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.729785158157895, 0.082892338070755 ], [ -119.730021679407798, 0.133364806198297 ], [ -119.733958161427495, 0.128415128773379 ], [ -119.733958161427495, 0.120773519377362 ], [ -119.738263303663899, 0.117006528031081 ], [ -119.748380387919298, 0.11937435122313 ], [ -119.763017871522905, 0.13454994030387 ], [ -119.765370018391195, 0.137018213077056 ], [ -119.773532568071303, 0.134693442804837 ], [ -119.778068058183294, 0.13473497670909 ], [ -119.772179214201898, 0.127334540763324 ], [ -119.771678958331904, 0.082737352532163 ], [ -119.729785158157895, 0.082892338070755 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Cheddarford", "description": null, "altitudeMode": "absolute", "Nbrhood": "Cheddarford", "Id": "13", "FID": "12", "Field_1": "Cheddarford" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.778068058183294, 0.13473497670909 ], [ -119.807465056792907, 0.135004180717343 ], [ -119.807594723193702, 0.120741322203315 ], [ -119.813923282281195, 0.110538155898039 ], [ -119.813515158058706, 0.079352596723408 ], [ -119.815882986288699, 0.077307656072233 ], [ -119.819542357189505, 0.07720002761414 ], [ -119.820833899860403, 0.075800857634563 ], [ -119.820941512548103, 0.069354938245539 ], [ -119.792170705009397, 0.069316211534405 ], [ -119.792847073636594, 0.082973327894255 ], [ -119.771678958331904, 0.082737352532163 ], [ -119.772179214201898, 0.127334540763324 ], [ -119.778068058183294, 0.13473497670909 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Easton", "description": null, "altitudeMode": "absolute", "Nbrhood": "Easton", "Id": "14", "FID": "13", "Field_1": "Easton" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.845430682091703, 0.135351852209671 ], [ -119.845328750099796, 0.148772874867194 ], [ -119.838139162565099, 0.15630684707498 ], [ -119.832286828807597, 0.166072292065914 ], [ -119.846687529588095, 0.166072292065914 ], [ -119.853791014278002, 0.163682948017941 ], [ -119.856567831020499, 0.163553794277497 ], [ -119.861863155971093, 0.165297369703459 ], [ -119.870106876525, 0.165213533434341 ], [ -119.877081206947807, 0.167744946383168 ], [ -119.876734511166902, 0.164724365900188 ], [ -119.876611814613099, 0.135325726957684 ], [ -119.845430682091703, 0.135351852209671 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Weston", "description": null, "altitudeMode": "absolute", "Nbrhood": "Weston", "Id": "15", "FID": "14", "Field_1": "Weston" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.877081206947807, 0.167744946383168 ], [ -119.8832806117681, 0.166918362598911 ], [ -119.891204011694498, 0.168781861219176 ], [ -119.897930796438402, 0.16781320839491 ], [ -119.9008367674478, 0.168566605040117 ], [ -119.900988438149597, 0.135611312563188 ], [ -119.876611814613099, 0.135325726957684 ], [ -119.876734511166902, 0.164724365900188 ], [ -119.877081206947807, 0.167744946383168 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Southton", "description": null, "altitudeMode": "absolute", "Nbrhood": "Southton", "Id": "16", "FID": "15", "Field_1": "Southton" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.876611814613099, 0.135325726957684 ], [ -119.900988438149597, 0.135611312563188 ], [ -119.900949703693598, 0.123769163602705 ], [ -119.895266915941704, 0.117655875197667 ], [ -119.883470826214094, 0.104223856630255 ], [ -119.877701935617395, 0.095183071631783 ], [ -119.876965553353699, 0.094297423903794 ], [ -119.876611814613099, 0.135325726957684 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "Oak Willow", "description": null, "altitudeMode": "absolute", "Nbrhood": "Oak Willow", "Id": "17", "FID": "16", "Field_1": "Oak Willow" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.877202513172904, 0.084594300409959 ], [ -119.874629695285506, 0.078071796275809 ], [ -119.871081540559004, 0.079526574213962 ], [ -119.844947174613196, 0.078996181198001 ], [ -119.844843851199599, 0.0693871117937 ], [ -119.820941512548103, 0.069354938245539 ], [ -119.820833899860403, 0.075800857634563 ], [ -119.819542357189505, 0.07720002761414 ], [ -119.815882986288699, 0.077307656072233 ], [ -119.813515158058706, 0.079352596723408 ], [ -119.813752490328298, 0.097487616748209 ], [ -119.817669438163605, 0.097706263586441 ], [ -119.819778957859398, 0.099729677434106 ], [ -119.833211001636897, 0.096156414599333 ], [ -119.842459882208004, 0.090229676629724 ], [ -119.873593273540095, 0.090241579117616 ], [ -119.871330325107706, 0.087519928196863 ], [ -119.870469296660403, 0.084334126525017 ], [ -119.875018970975802, 0.0842330992965 ], [ -119.877202513172904, 0.084594300409959 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "East Parton", "description": null, "altitudeMode": "absolute", "Nbrhood": "East Parton", "Id": "18", "FID": "17", "Field_1": "East Parton" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.845769348022699, 0.090230941858943 ], [ -119.842459882208004, 0.090229676629724 ], [ -119.833211001636897, 0.096156414599333 ], [ -119.819778957859398, 0.099729677434106 ], [ -119.817669438163605, 0.097706263586441 ], [ -119.813752490328298, 0.097487616748209 ], [ -119.813923282281195, 0.110538155898039 ], [ -119.807594723193702, 0.120741322203315 ], [ -119.807465056792907, 0.135004180717343 ], [ -119.845430682091703, 0.135351852209671 ], [ -119.845769348022699, 0.090230941858943 ] ] ] ] } }, { "type": "Feature", "properties": { "Name": "West Parton", "description": null, "altitudeMode": "absolute", "Nbrhood": "West Parton", "Id": "19", "FID": "18", "Field_1": "West Parton" }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -119.845430682091703, 0.135351852209671 ], [ -119.876611814613099, 0.135325726957684 ], [ -119.876965553353699, 0.094297423903794 ], [ -119.873593273540095, 0.090241579117616 ], [ -119.845769348022699, 0.090230941858943 ], [ -119.845430682091703, 0.135351852209671 ] ] ] ] } } ]}

            var width = 900;
            var height = 350;
            const maxNbrhoodPosts = 1409;
            var Nbrhoods = {};
            geojsonData.features.forEach(element => {
                Nbrhoods[`${element.properties.Name}`] = {};
                Nbrhoods[`${element.properties.Name}`]["num_posts"] = 0;
                Nbrhoods[`${element.properties.Name}`]["sentiment"] = 1;
            });
            Nbrhoods["UNKNOWN"] = {};
            Nbrhoods["UNKNOWN"]["num_posts"] = 0;
            Nbrhoods["UNKNOWN"]["sentiment"] = 1;

            Nbrhoods["<Location with-held due to contract>"] = {};
            Nbrhoods["<Location with-held due to contract>"]["num_posts"] = 0;
            Nbrhoods["<Location with-held due to contract>"]["sentiment"] = 1;


                
            
            //Properly scaled projection - very tedious, be careful changing
            var projection = d3.geoMercator()
            .scale(1)
            .center([-100.0, 60.0]) 
            .translate([0,0])

            let all_data;

            
            // Rendering YINT data from data.csv file
            d3.csv("static/data/data.csv", function(data) {
                all_data = data;
                all_data

                data.forEach(element => {
                    Nbrhoods[`${element.location}`]["num_posts"]++;
                });

                


                var colors = d3.scaleSequential().domain([0,1])
                                                .interpolator(d3.interpolateYlGn);
                

                
                map.selectAll("path")
                    .data(mapData.features)
                    .enter().append("path")
                    .attr("d", path)
                    .style("stroke", "white")
                    .style("fill", function(d){return colors(Nbrhoods[`${d.properties.Name}`]["num_posts"]/maxNbrhoodPosts);})
                    .on("mouseover", handleMouseover)
                    .on("mouseout", handleMouseout);

                map.append("circle")
                    .attr('cx', 120)
                    .attr('cy', 85)
                    .attr('r','10px')
                    .style('fill', 'green')
                    .on("mouseover", function(d){
                                        tooltip.style("opacity", .9)
                                                .html("Unknown Location <br># Posts: " + (Nbrhoods["<Location with-held due to contract>"]["num_posts"] + Nbrhoods["UNKNOWN"]["num_posts"]))
                    })
                    .on("mouseout", function(d){tooltip.style("opacity", 0)});

                // var triangles = d3.symbol().type("symbolDiamond").size(100);

                map.append('circle')
                    .attr('transform', "translate(530, 200)")
                    .attr('r','5px')
                    .attr("fill", "#AF3B6E")
                    .attr("opacity",0.9);
                });


            var map = d3.select("#map").append("svg")
            .attr("width", `${width}px`)
            .attr("height", `${height}px`);

            var path = d3.geoPath()
            .projection(projection);

            var g = map.append("g");

            //Bind data and create one path per GeoJSON feature, add features
            mapData = geojsonData;

            var b = path.bounds(mapData);
            var s = .95 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),
                t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];

            projection
                .scale(s)
                .translate(t);


            var tooltip = d3.select("#map").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0)

            // var triangles = d3.map.symbol().type('triangle-up');


            var handleMouseover = function(d){

            tooltip
                .style("opacity", .9)
                .html(d.properties["Name"] + "<br>" + Nbrhood_sentiment(d))
                .style("left", function() { return (path.centroid(d)["0"] + "px")})
                .style("top", function() { return (path.centroid(d)["1"] + "px")}) 

            d3.select(this)
                .style("opacity", .8);

            }

            var handleMouseout = function(d){
                tooltip
                    .style("opacity", 0)
                d3.select(this)
                    .style("opacity", 1);
                
            }

            var Nbrhood_sentiment =  function(d){
                if(Nbrhoods[d.properties.Name]["sentiment"] < 0){
                    return "Average Sentiment: Negative"
                }
                else{
                    return "Average Sentiment Score: Positive"
                }
            }

    </script>
</body>

